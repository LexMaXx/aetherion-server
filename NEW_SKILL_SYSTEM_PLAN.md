# –ü–õ–ê–ù –°–û–ó–î–ê–ù–ò–Ø –ù–û–í–û–ô –°–ò–°–¢–ï–ú–´ –°–ö–ò–õ–õ–û–í

**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:** 21 –æ–∫—Ç—è–±—Ä—è 2025
**–°—Ç–∞—Ç—É—Å:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (Step 1/7 –≤—ã–ø–æ–ª–Ω–µ–Ω)

---

## –¶–ï–õ–ò –°–ò–°–¢–ï–ú–´

### ‚úÖ –ß—Ç–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:

1. **–í—Å–µ —Ç–∏–ø—ã —Å–∫–∏–ª–ª–æ–≤:**
   - –°–Ω–∞—Ä—è–¥—ã (Fireball, Arrow, Hammer of Justice)
   - –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —É—Ä–æ–Ω (Holy Strike, Backstab)
   - AOE (Ice Nova, Explosive Arrow)
   - –õ–µ—á–µ–Ω–∏–µ (Lay on Hands)
   - –ë–∞—Ñ—Ñ—ã (Battle Cry, Divine Shield)
   - –î–µ–±–∞—Ñ—ã (Poison, Slow)
   - –ö–æ–Ω—Ç—Ä–æ–ª—å (Stun, Root, Sleep, Silence)
   - –î–≤–∏–∂–µ–Ω–∏–µ (Charge, Teleport, Shadow Step)
   - –ü—Ä–∏–∑—ã–≤ (Summon Skeletons)
   - –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è (Bear Form)

2. **–í—Å–µ —ç—Ñ—Ñ–µ–∫—Ç—ã:**
   - DoT (Damage over Time) - Poison, Burn, Bleed
   - HoT (Heal over Time) - Regeneration
   - CC (Crowd Control) - Stun, Root, Sleep, Fear, Silence
   - –ë–∞—Ñ—Ñ—ã - Increase Attack/Defense/Speed
   - –î–µ–±–∞—Ñ—Ñ—ã - Decrease Attack/Defense/Speed
   - –û—Å–æ–±—ã–µ - Shield, Invulnerability, Invisibility

3. **–ü–æ–ª–Ω–∞—è —Å–µ—Ç–µ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**
   - –í—Å–µ –∏–≥—Ä–æ–∫–∏ –≤–∏–¥—è—Ç —Å–Ω–∞—Ä—è–¥—ã
   - –í—Å–µ –∏–≥—Ä–æ–∫–∏ –≤–∏–¥—è—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
   - –í—Å–µ –∏–≥—Ä–æ–∫–∏ –≤–∏–¥—è—Ç –∞—É—Ä—ã –∏ —á–∞—Å—Ç–∏—Ü—ã —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
   - –í—Å–µ –∏–≥—Ä–æ–∫–∏ –≤–∏–¥—è—Ç –∞–Ω–∏–º–∞—Ü–∏–∏
   - –£—Ä–æ–Ω –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

4. **–°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ cooldown –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ mana –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —á–∏—Ç–µ—Ä—Å—Ç–≤–∞

---

## –ü–û–®–ê–ì–û–í–´–ô –ü–õ–ê–ù –†–ê–ó–†–ê–ë–û–¢–ö–ò

### ‚úÖ STEP 1: –ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (–ó–ê–í–ï–†–®–ï–ù–û)

**–°–æ–∑–¥–∞–Ω–æ:**
- ‚úÖ `SkillConfig.cs` - ScriptableObject –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–∏–ª–ª–æ–≤
- ‚úÖ `EffectConfig.cs` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Å—Ç–∞—Ç—É—Å-—ç—Ñ—Ñ–µ–∫—Ç–æ–≤

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –í—Å–µ —Ç–∏–ø—ã —Å–∫–∏–ª–ª–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è
- –í—Å–µ —Ç–∏–ø—ã —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã (30+ —Ç–∏–ø–æ–≤)
- –ú–µ—Ç–æ–¥—ã —Ä–∞—Å—á—ë—Ç–∞ —É—Ä–æ–Ω–∞/–ª–µ—á–µ–Ω–∏—è
- –ú–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ (CanUse, IsCrowdControl, –∏ —Ç.–¥.)

---

### üîÑ STEP 2: Execution Logic (–í –ü–†–û–¶–ï–°–°–ï)

**–ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:**

#### 2.1. `SkillExecutor.cs`
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∫–∏–ª–ª—ã.

```csharp
public class SkillExecutor : MonoBehaviour
{
    // –°–ø–∏—Å–æ–∫ —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∫–∏–ª–ª–æ–≤ (3 —Å–ª–æ—Ç–∞)
    public List<SkillConfig> equippedSkills;

    // –ö—É–ª–¥–∞—É–Ω—ã
    private Dictionary<int, float> skillCooldowns;

    // –°—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    private CharacterStats stats;
    private ManaSystem manaSystem;
    private EffectManager effectManager;
    private Animator animator;

    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫–∏–ª–ª
    public bool UseSkill(int slotIndex, Transform target = null)
    {
        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∏ (cooldown, mana, range)
        // 2. –¢—Ä–∞—Ç–∞ –º–∞–Ω—ã
        // 3. –ó–∞–ø—É—Å–∫ cooldown
        // 4. –ê–Ω–∏–º–∞—Ü–∏—è
        // 5. –û–¢–ü–†–ê–í–ö–ê –ù–ê –°–ï–†–í–ï–†
        // 6. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ
    }

    // –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∫–∏–ª–ª (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞)
    private void ExecuteSkill(SkillConfig skill, Transform target, Vector3 targetPos)
    {
        switch (skill.skillType)
        {
            case ProjectileDamage:
                SpawnProjectile(skill, target);
                break;
            case InstantDamage:
                DealInstantDamage(skill, target);
                break;
            case AOEDamage:
                DealAOEDamage(skill, targetPos);
                break;
            // ... –∏ —Ç.–¥.
        }
    }
}
```

#### 2.2. `EffectManager.cs`
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏.

```csharp
public class EffectManager : MonoBehaviour
{
    // –ê–∫—Ç–∏–≤–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ
    private List<ActiveEffect> activeEffects;

    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç
    public void ApplyEffect(EffectConfig effect, CharacterStats casterStats, string casterSocketId)
    {
        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –ª–∏ —ç—Ñ—Ñ–µ–∫—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω—ë–Ω (–∏–º–º—É–Ω–∏—Ç–µ—Ç, —Å—Ç–∞–∫–∏)
        // 2. –°–æ–∑–¥–∞—Ç—å ActiveEffect
        // 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã stats)
        // 4. –°–æ–∑–¥–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (—á–∞—Å—Ç–∏—Ü—ã)
        // 5. –û–¢–ü–†–ê–í–ö–ê –ù–ê –°–ï–†–í–ï–† (–µ—Å–ª–∏ syncWithServer)
        // 6. –î–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ activeEffects
    }

    // –£–¥–∞–ª–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç
    public void RemoveEffect(int effectId)
    {
        // 1. –ù–∞–π—Ç–∏ —ç—Ñ—Ñ–µ–∫—Ç
        // 2. –°–Ω—è—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
        // 3. –£–¥–∞–ª–∏—Ç—å –≤–∏–∑—É–∞–ª
        // 4. –û–¢–ü–†–ê–í–ö–ê –ù–ê –°–ï–†–í–ï–†
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä (—Ç–∏–∫–∏ —É—Ä–æ–Ω–∞/–ª–µ—á–µ–Ω–∏—è)
    void Update()
    {
        UpdateEffects();
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º
    public bool IsUnderCrowdControl()
    {
        return activeEffects.Any(e => e.config.IsCrowdControl());
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –ª–∏ –¥–≤–∏–≥–∞—Ç—å—Å—è
    public bool CanMove()
    {
        return !activeEffects.Any(e => e.config.BlocksMovement());
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –ª–∏ –∞—Ç–∞–∫–æ–≤–∞—Ç—å
    public bool CanAttack()
    {
        return !activeEffects.Any(e => e.config.BlocksAttacks());
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫–∏–ª–ª—ã
    public bool CanUseSkills()
    {
        return !activeEffects.Any(e => e.config.BlocksSkills());
    }
}

// –ê–∫—Ç–∏–≤–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (–∏–Ω—Å—Ç–∞–Ω—Å)
public class ActiveEffect
{
    public EffectConfig config;
    public float remainingDuration;
    public float nextTickTime;
    public CharacterStats casterStats;  // –î–ª—è —Ä–∞—Å—á—ë—Ç–∞ DoT/HoT
    public string casterSocketId;       // –î–ª—è —Å–µ—Ç–µ–≤–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    public GameObject visualEffect;     // –ß–∞—Å—Ç–∏—Ü—ã
    public int stackCount;              // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞–∫–æ–≤
}
```

---

### üìã STEP 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PlayerAttackNew

**–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `PlayerAttackNew.cs`:**

```csharp
public class PlayerAttackNew : MonoBehaviour
{
    [Header("Basic Attack")]
    public BasicAttackConfig attackConfig;  // –£–ñ–ï –ï–°–¢–¨

    [Header("Skills")]
    public List<SkillConfig> equippedSkills = new List<SkillConfig>(3);  // –ù–û–í–û–ï

    private SkillExecutor skillExecutor;  // –ù–û–í–û–ï
    private EffectManager effectManager;  // –ù–û–í–û–ï

    void Start()
    {
        skillExecutor = GetComponent<SkillExecutor>();
        effectManager = GetComponent<EffectManager>();

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫–∏–ª–ª—ã –∏–∑ PlayerPrefs –∏–ª–∏ SkillDatabase
        LoadEquippedSkills();
    }

    void Update()
    {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –ª–∏ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å
        if (effectManager != null && effectManager.IsUnderCrowdControl())
        {
            return; // –ü–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º - –Ω–µ –º–æ–∂–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å
        }

        // –õ–ö–ú - basic attack (–£–ñ–ï –†–ê–ë–û–¢–ê–ï–¢)
        if (Input.GetMouseButtonDown(0))
        {
            if (effectManager == null || effectManager.CanAttack())
            {
                PerformBasicAttack();
            }
        }

        // 1/2/3 - —Å–∫–∏–ª–ª—ã (–ù–û–í–û–ï)
        if (Input.GetKeyDown(KeyCode.Alpha1))
        {
            if (effectManager == null || effectManager.CanUseSkills())
            {
                skillExecutor?.UseSkill(0, currentTarget);
            }
        }
        if (Input.GetKeyDown(KeyCode.Alpha2))
        {
            if (effectManager == null || effectManager.CanUseSkills())
            {
                skillExecutor?.UseSkill(1, currentTarget);
            }
        }
        if (Input.GetKeyDown(KeyCode.Alpha3))
        {
            if (effectManager == null || effectManager.CanUseSkills())
            {
                skillExecutor?.UseSkill(2, currentTarget);
            }
        }
    }
}
```

---

### üåê STEP 4: –°–µ—Ç–µ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–ö–ª–∏–µ–Ω—Ç)

**–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `SocketIOManager.cs`:**

```csharp
// –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫–∏–ª–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
public void SendSkillCast(int skillId, string targetSocketId, Vector3 targetPosition)
{
    var data = new
    {
        skillId = skillId,
        targetSocketId = targetSocketId,
        targetPosition = new { x = targetPosition.x, y = targetPosition.y, z = targetPosition.z },
        timestamp = GetCurrentTimestamp()
    };

    Emit("player_skill_cast", JsonConvert.SerializeObject(data));
}

// –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
public void SendEffectApplied(int skillId, int effectIndex, string targetSocketId, float duration)
{
    var data = new
    {
        skillId = skillId,
        effectIndex = effectIndex,
        targetSocketId = targetSocketId,
        duration = duration
    };

    Emit("effect_applied", JsonConvert.SerializeObject(data));
}
```

**–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `NetworkSyncManager.cs`:**

```csharp
void Start()
{
    // –£–∂–µ –µ—Å—Ç—å
    SocketIOManager.Instance.On("player_used_skill", OnPlayerSkillUsed);

    // –ù–û–í–´–ï —Å–æ–±—ã—Ç–∏—è
    SocketIOManager.Instance.On("skill_casted", OnSkillCasted);
    SocketIOManager.Instance.On("effect_applied", OnEffectApplied);
    SocketIOManager.Instance.On("effect_removed", OnEffectRemoved);
}

// –°–µ—Ä–≤–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫–∏–ª–ª–∞
private void OnSkillCasted(string jsonData)
{
    var data = JsonConvert.DeserializeObject<SkillCastedEvent>(jsonData);

    // –ï—Å–ª–∏ —ç—Ç–æ –ù–ï –Ω–∞—à —Å–∫–∏–ª–ª
    if (data.socketId != localPlayerSocketId)
    {
        // –ù–∞–π—Ç–∏ NetworkPlayer
        if (networkPlayers.TryGetValue(data.socketId, out NetworkPlayer player))
        {
            // –ü–æ–ª—É—á–∏—Ç—å SkillConfig
            SkillConfig skill = GetSkillConfigById(data.skillId);

            // –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            SkillExecutor executor = player.GetComponent<SkillExecutor>();
            executor?.ExecuteSkillVisuals(skill, data.targetPosition);
        }
    }
}

// –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏–º–µ–Ω—ë–Ω –Ω–∞ —Ü–µ–ª—å
private void OnEffectApplied(string jsonData)
{
    var data = JsonConvert.DeserializeObject<EffectAppliedEvent>(jsonData);

    // –ù–∞–π—Ç–∏ —Ü–µ–ª—å
    GameObject target = FindTargetBySocketId(data.targetSocketId);

    if (target != null)
    {
        EffectManager effectMgr = target.GetComponent<EffectManager>();
        SkillConfig skill = GetSkillConfigById(data.skillId);

        if (effectMgr != null && skill != null)
        {
            // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç (–¢–û–õ–¨–ö–û –≤–∏–∑—É–∞–ª, —É—Ä–æ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
            EffectConfig effect = skill.effects[data.effectIndex];
            effectMgr.ApplyEffectVisual(effect, data.duration);
        }
    }
}
```

---

### üñ•Ô∏è STEP 5: –°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (Server)

**–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `server.js`:**

```javascript
// –•—Ä–∞–Ω–µ–Ω–∏–µ –∫—É–ª–¥–∞—É–Ω–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
const playerCooldowns = new Map(); // socketId -> {skillId: expireTime}

// –ò–≥—Ä–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∫–∏–ª–ª
socket.on('player_skill_cast', (data) => {
  try {
    const { skillId, targetSocketId, targetPosition, timestamp } = JSON.parse(data);

    const player = players.get(socket.id);
    if (!player) return;

    // 1. –í–ê–õ–ò–î–ê–¶–ò–Ø: –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Å–∫–∏–ª–ª–∞
    const skillConfig = getSkillConfig(skillId);
    if (!skillConfig) {
      socket.emit('skill_error', { error: 'Invalid skill ID' });
      return;
    }

    // 2. –í–ê–õ–ò–î–ê–¶–ò–Ø: –ü—Ä–æ–≤–µ—Ä–∫–∞ cooldown
    if (isSkillOnCooldown(socket.id, skillId)) {
      socket.emit('skill_error', { error: 'Skill on cooldown' });
      return;
    }

    // 3. –í–ê–õ–ò–î–ê–¶–ò–Ø: –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–Ω—ã
    if (player.mana < skillConfig.manaCost) {
      socket.emit('skill_error', { error: 'Not enough mana' });
      return;
    }

    // 4. –í–ê–õ–ò–î–ê–¶–ò–Ø: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª—å–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å —Ü–µ–ª—å)
    if (targetSocketId) {
      const target = players.get(targetSocketId);
      if (target) {
        const distance = calculateDistance(player.position, target.position);
        if (distance > skillConfig.castRange) {
          socket.emit('skill_error', { error: 'Target out of range' });
          return;
        }
      }
    }

    // 5. –í–°–Å –û–ö: –°–ø–∏—Å–∞—Ç—å –º–∞–Ω—É
    player.mana -= skillConfig.manaCost;
    player.mana = Math.max(0, player.mana);

    // 6. –í–°–Å –û–ö: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å cooldown
    setSkillCooldown(socket.id, skillId, skillConfig.cooldown);

    // 7. –í–°–Å –û–ö: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –í–°–ï–ú –≤ –∫–æ–º–Ω–∞—Ç–µ
    io.to(player.roomId).emit('skill_casted', JSON.stringify({
      socketId: socket.id,
      skillId: skillId,
      targetSocketId: targetSocketId,
      targetPosition: targetPosition,
      timestamp: Date.now()
    }));

    console.log(`[Server] ${player.username} used skill ${skillId}`);

  } catch (error) {
    console.error('[Server] Error in player_skill_cast:', error);
  }
});

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞
socket.on('effect_applied', (data) => {
  const { skillId, effectIndex, targetSocketId, duration } = JSON.parse(data);

  const player = players.get(socket.id);
  if (!player) return;

  // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –í–°–ï–ú –≤ –∫–æ–º–Ω–∞—Ç–µ
  io.to(player.roomId).emit('effect_applied', JSON.stringify({
    casterSocketId: socket.id,
    skillId: skillId,
    effectIndex: effectIndex,
    targetSocketId: targetSocketId,
    duration: duration
  }));
});

// –£—Ç–∏–ª–∏—Ç—ã
function getSkillConfig(skillId) {
  // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ –∏–∑ JSON —Ñ–∞–π–ª–∞ –∏–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  return skillConfigs[skillId];
}

function isSkillOnCooldown(socketId, skillId) {
  if (!playerCooldowns.has(socketId)) return false;

  const cooldowns = playerCooldowns.get(socketId);
  if (!cooldowns[skillId]) return false;

  return Date.now() < cooldowns[skillId];
}

function setSkillCooldown(socketId, skillId, duration) {
  if (!playerCooldowns.has(socketId)) {
    playerCooldowns.set(socketId, {});
  }

  const cooldowns = playerCooldowns.get(socketId);
  cooldowns[skillId] = Date.now() + (duration * 1000);
}
```

---

### üé® STEP 6: –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–∏

**–°–æ–∑–¥–∞—Ç—å –ø—Ä–µ—Ñ–∞–±—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:**

1. **DoT —ç—Ñ—Ñ–µ–∫—Ç—ã:**
   - Burn - –æ–≥–Ω–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã –≤–æ–∫—Ä—É–≥ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
   - Poison - –∑–µ–ª—ë–Ω—ã–µ –ø—É–∑—ã—Ä–∏/–¥—ã–º
   - Bleed - –∫—Ä–∞—Å–Ω—ã–µ –∫–∞–ø–ª–∏ –∫—Ä–æ–≤–∏

2. **CC —ç—Ñ—Ñ–µ–∫—Ç—ã:**
   - Stun - –∑–≤—ë–∑–¥—ã –≤–æ–∫—Ä—É–≥ –≥–æ–ª–æ–≤—ã
   - Root - –∫–æ—Ä–Ω–∏ —É –Ω–æ–≥
   - Sleep - Z Z Z –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π
   - Silence - –∑–∞–ø—Ä–µ—â–∞—é—â–∏–π —Å–∏–º–≤–æ–ª
   - Fear - —Ç—ë–º–Ω–∞—è –∞—É—Ä–∞

3. **Buff —ç—Ñ—Ñ–µ–∫—Ç—ã:**
   - Increase Attack - –∫—Ä–∞—Å–Ω–∞—è –∞—É—Ä–∞
   - Increase Defense - —Å–∏–Ω—è—è –∞—É—Ä–∞
   - Increase Speed - –±–µ–ª—ã–µ –ª–∏–Ω–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è
   - Shield - –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —â–∏—Ç

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ EffectManager:**
```csharp
private GameObject CreateVisualEffect(EffectConfig effect, Transform parent)
{
    if (effect.particleEffectPrefab == null) return null;

    GameObject vfx = Instantiate(effect.particleEffectPrefab, parent);
    vfx.transform.localPosition = Vector3.up * 1.5f; // –ù–∞–¥ –≥–æ–ª–æ–≤–æ–π

    return vfx;
}
```

---

### üß™ STEP 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

1. **Single-player —Ç–µ—Å—Ç:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫–∏–ª–ª –Ω–∞ –≤—Ä–∞–≥–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Ä–æ–Ω
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DoT —Ç–∏–∫–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CC (stun –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è)

2. **Multiplayer —Ç–µ—Å—Ç (–ª–æ–∫–∞–ª—å–Ω–æ, 2 –∫–ª–∏–µ–Ω—Ç–∞):**
   - –ò–≥—Ä–æ–∫ 1 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Fireball
   - –ò–≥—Ä–æ–∫ 2 –≤–∏–¥–∏—Ç —Å–Ω–∞—Ä—è–¥
   - –ò–≥—Ä–æ–∫ 2 –≤–∏–¥–∏—Ç –≤–∑—Ä—ã–≤
   - –ò–≥—Ä–æ–∫ 1 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Stun
   - –ò–≥—Ä–æ–∫ 2 –≤–∏–¥–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç stun
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ò–≥—Ä–æ–∫ 2 –Ω–µ –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è

3. **–¢–µ—Å—Ç –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Å–∫–∏–ª–ª–∞:**
   - ‚úÖ ProjectileDamage (Fireball)
   - ‚úÖ InstantDamage (Holy Strike)
   - ‚úÖ AOEDamage (Ice Nova)
   - ‚úÖ Heal (Lay on Hands)
   - ‚úÖ Buff (Battle Cry)
   - ‚úÖ CrowdControl (Hammer of Justice - Stun)
   - ‚úÖ Movement (Charge)

4. **–¢–µ—Å—Ç —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:**
   - ‚úÖ Burn (DoT)
   - ‚úÖ Poison (DoT)
   - ‚úÖ Stun (–±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è)
   - ‚úÖ Root (–±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ)
   - ‚úÖ Silence (–±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–∫–∏–ª–ª—ã)
   - ‚úÖ Shield (–ø–æ–≥–ª–æ—â–∞–µ—Ç —É—Ä–æ–Ω)

---

## –¢–ï–ö–£–©–ò–ô –ü–†–û–ì–†–ï–°–°

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ:

1. ‚úÖ –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã SkillData
2. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ SkillConfig.cs (–±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
3. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ EffectConfig.cs (30+ —Ç–∏–ø–æ–≤ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤)
4. ‚úÖ –ú–µ—Ç–æ–¥—ã —Ä–∞—Å—á—ë—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ:

5. üîÑ –°–æ–∑–¥–∞–Ω–∏–µ SkillExecutor.cs
6. üîÑ –°–æ–∑–¥–∞–Ω–∏–µ EffectManager.cs

### üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

7. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PlayerAttackNew.cs
8. ‚è≥ –°–µ—Ç–µ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–∫–ª–∏–µ–Ω—Ç)
9. ‚è≥ –°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
10. ‚è≥ –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
11. ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –ú–ò–ì–†–ê–¶–ò–Ø –°–ö–ò–õ–õ–û–í

### –ü–ª–∞–Ω –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑ SkillData –≤ SkillConfig:

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Editor Script:**

```csharp
#if UNITY_EDITOR
[MenuItem("Aetherion/Convert SkillData to SkillConfig")]
static void ConvertSkills()
{
    // 1. –ù–∞–π—Ç–∏ –≤—Å–µ SkillData —Ñ–∞–π–ª—ã
    string[] guids = AssetDatabase.FindAssets("t:SkillData");

    foreach (string guid in guids)
    {
        string path = AssetDatabase.GUIDToAssetPath(guid);
        SkillData oldSkill = AssetDatabase.LoadAssetAtPath<SkillData>(path);

        // 2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π SkillConfig
        SkillConfig newSkill = ScriptableObject.CreateInstance<SkillConfig>();

        // 3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
        newSkill.skillId = oldSkill.skillId;
        newSkill.skillName = oldSkill.skillName;
        newSkill.description = oldSkill.description;
        // ... –∏ —Ç.–¥.

        // 4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
        string newPath = path.Replace("Skills/", "Skills/NEW/");
        AssetDatabase.CreateAsset(newSkill, newPath);
    }

    AssetDatabase.SaveAssets();
    Debug.Log("Conversion complete!");
}
#endif
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (–∫–∞–∫–∏–µ —Å–∫–∏–ª–ª—ã –¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—ã–º–∏):

**–§–∞–∑–∞ 1 (–¢–µ—Å—Ç–æ–≤—ã–µ):**
1. Mage_Fireball (ProjectileDamage + Burn effect)
2. Warrior_Charge (Movement + InstantDamage)
3. Paladin_LayonHands (Heal)

**–§–∞–∑–∞ 2 (–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ):**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ Editor Script
- –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Å–∫–∏–ª–ª–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

---

## –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨ –°–û –°–¢–ê–†–û–ô –°–ò–°–¢–ï–ú–û–ô

### –ü–µ—Ä–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–∏–æ–¥:

1. **–û—Å—Ç–∞–≤–∏—Ç—å SkillData.cs –∏ SkillManager.cs** –≤ –ø—Ä–æ–µ–∫—Ç–µ
2. **–°–æ–∑–¥–∞—Ç—å SkillConfig.cs –∏ SkillExecutor.cs** –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
3. **PlayerAttackNew.cs** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¢–û–õ–¨–ö–û SkillConfig
4. **–°—Ç–∞—Ä—ã–π PlayerAttack.cs** (–µ—Å–ª–∏ –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SkillData
5. –ö–æ–≥–¥–∞ –≤—Å–µ —Å–∫–∏–ª–ª—ã –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã - —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É

### –ò–∑–æ–ª—è—Ü–∏—è:

- –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞: `Assets/Scripts/Skills/SkillConfig.cs`, `SkillExecutor.cs`, `EffectManager.cs`
- –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞: `Assets/Scripts/Skills/SkillData.cs`, `SkillManager.cs`
- –ù–ï–¢ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É –Ω–∏–º–∏

---

## –ì–û–¢–û–í –ö –ü–†–û–î–û–õ–ñ–ï–ù–ò–Æ

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: **–°–æ–∑–¥–∞–Ω–∏–µ SkillExecutor.cs**

–ö–æ–≥–¥–∞ —Å–∫–∞–∂–µ—à—å - –ø—Ä–æ–¥–æ–ª–∂—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É! üöÄ

using UnityEngine;

/// <summary>
/// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∏–≥—Ä—ã
/// –î–æ–±–∞–≤—å —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–∞ –ª—é–±–æ–π GameObject –≤ –ø–µ—Ä–≤–æ–π —Å—Ü–µ–Ω–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä MainMenu)
/// </summary>
public class NetworkInitializer : MonoBehaviour
{
    [Header("Auto Setup")]
    [SerializeField] private bool autoCreateNetworkManagers = true;

    void Awake()
    {
        if (!autoCreateNetworkManagers) return;

        // –°–æ–∑–¥–∞—ë–º SimpleWebSocketClient –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
        if (SimpleWebSocketClient.Instance == null)
        {
            GameObject wsClient = new GameObject("SimpleWebSocketClient");
            wsClient.AddComponent<SimpleWebSocketClient>();
            DontDestroyOnLoad(wsClient);
            Debug.Log("[NetworkInitializer] ‚úÖ –°–æ–∑–¥–∞–Ω SimpleWebSocketClient");
        }

        // –°–æ–∑–¥–∞—ë–º RoomManager –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
        if (RoomManager.Instance == null)
        {
            GameObject roomMgr = new GameObject("RoomManager");
            roomMgr.AddComponent<RoomManager>();
            DontDestroyOnLoad(roomMgr);
            Debug.Log("[NetworkInitializer] ‚úÖ –°–æ–∑–¥–∞–Ω RoomManager");
        }

        // –°–æ–∑–¥–∞—ë–º ApiClient –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
        if (ApiClient.Instance == null)
        {
            GameObject apiClient = new GameObject("ApiClient");
            apiClient.AddComponent<ApiClient>();
            DontDestroyOnLoad(apiClient);
            Debug.Log("[NetworkInitializer] ‚úÖ –°–æ–∑–¥–∞–Ω ApiClient");
        }

        Debug.Log("[NetworkInitializer] üöÄ –í—Å–µ —Å–µ—Ç–µ–≤—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –≥–æ—Ç–æ–≤—ã!");
    }
}
